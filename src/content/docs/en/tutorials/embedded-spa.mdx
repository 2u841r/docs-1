---
title: Tutorial - Embedded SPA
description: >-
  Embed a Create React App directly in your Astro site.
i18nReady: true
---
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro';
import Box from '~/components/tutorial/Box.astro';
import MultipleChoice from '~/components/tutorial/MultipleChoice.astro';
import Option from '~/components/tutorial/Option.astro';
import Spoiler from '~/components/Spoiler.astro';
import PreCheck from '~/components/tutorial/PreCheck.astro';
import FileTree from '~/components/FileTree.astro'


This tutorial describes embedding an existing Create-React-App (CRA) app into a new Astro project.

## Embedded SPA

A **single-page application (SPA)** adds an entire JavaScript app to `index.html`, turning that single page into an app whose content is refreshed client-side depending on the "page" the visitor selects.

Similarly, `index.astro` can render an **embedded SPA** from any UI framework as an [Astro island](/en/concepts/islands/) allowing your existing app to run entirely at the root of an Astro project in just a few lines of code. 

```astro title="src/pages/index.astro"
---
// Import your root App component
import App from '../cra-project/App.jsx'
---
<!-- Use a client directive to load your app -->
<App client:load />
```

And as a **multi-page application**, Astro can also generate additional pages and API routes in Astro for more traditional page content at other routes... or even more embedded SPAs! This powerful embedded SPA pattern allows you to use one Astro project to house:

- An app alongside your blog, or portfolio.
- An eCommerce shop for a collection of apps, each with their own documentation and working demo.
- Any combination of traditional web site/app pages and interactive framework components or full-fledged running apps!

Over time, you may find that instead of simply embedding, you want to migrate a SPA [(e.g. Create-React-App)](/en/guides/migrate-to-astro/from-create-react-app/) by rewriting some or all of it as an Astro app. The embedded SPA pattern allows you to update incrementally, first getting your app running in your Astro project, and then refactoring to leverage the benefits of working in Astro.

<Box icon="question-mark">
<h3>Test your knowledge</h3>

What is an "embedded SPA"?

    <MultipleChoice>
      <Option>
         A pattern that lets you insert an existing project into Astro.
      </Option>
      <Option>
        An "island" of interactivity on an otherwise static page.
      </Option>
      <Option>
        A way to include a full app inside a website along with other features, such as a blog or docs.
      </Option>
      <Option isCorrect>
         All of the above!
      </Option>
    </MultipleChoice>

</Box>

## Prerequisites

1. **An existing Create-React-App project:** This tutorial uses the [Remix Run basic React Router Example](https://github.com/remix-run/react-router/tree/dev/examples). Download or copy this codebase for use. (Note: you do not need to run or build this app locally.)

    You can instead follow these steps with your own CRA project, or with an existing Astro project, but you will need to adjust the instructions for your codebase.

    **We recommend using this sample project** to complete this short tutorial **in a new Astro project first.** Then, you can use what you have learned to embed your own SPA in a new or existing Astro existing project.


## React Router Example Code

In the [Remix Run basic React Router Example](https://github.com/remix-run/react-router/tree/dev/examples), a single HTML file runs a script at `main.tsx` to render a React app to the page.

The Astro page located at `src/pages/index.astro` renders `index.html` for any Astro site. 

Instead of using a script to run your app, Astro can render React components directly to the page (e.g `<Main />`).

You will slightly modify the example SPA code to create a component and embed an entire React app directly in an Astro project.


## 1. Create a new Astro project

Run the following command in your terminal to start our handy install wizard:

<PackageManagerTabs>
  <Fragment slot="npm">
  ```shell
  # create a new project with npm
  npm create astro@latest -- --template basics
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```shell
  # create a new project with pnpm
  pnpm create astro@latest --template basics
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```shell
  # create a new project with yarn
  yarn create astro --template basics
  ```
  </Fragment>
</PackageManagerTabs>

## 2. Add dependencies

Your React app requires the `@astrojs/react` inegration to render React components. Run the `astro add` command using the package manager of your choice and our automatic integration wizard will update your configuration file and install any necessary dependencies.

<PackageManagerTabs>
  <Fragment slot="npm">
  ```shell
  npx astro add react
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```shell
  pnpm astro add react
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```shell
  yarn astro add react
  ```
  </Fragment>
</PackageManagerTabs>

Additionally, the Remix Run starter with React Router requires `react-router-dom`. You must also install this from the command line.

<PackageManagerTabs>
  <Fragment slot="npm">
  ```shell
  npm install react-router-dom
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```shell
  pnpm install react-router-dom
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```shell
  yarn add react-router-dom
  ```
  </Fragment>
</PackageManagerTabs>


## 3. Copy app files into Astro

The basic structure of the [Remix Run basic React Router Example](https://github.com/remix-run/react-router/tree/dev/examples) is some source files and an `index.html` as an entry page.

<FileTree>
- **src/**
  - **App.jsx**
  - **index.css**
  - **main.tsx**
  - vite-env.d.ts
- README.md
- index.html
- package-lock.json
- package.json
- tsconfig.json
- vite.config.ts
</FileTree>

Rename the `src` directory to `cra` and copy this directory into the `src/` folder of your Astro project. These files are the only ones needed to run your embedded SPA. It is safe to delete `vite-env.d.ts`.

The empty **basics** Astro project you created will now have the following files and folders:

<FileTree>
- public/
  - favicon.svg
- src/
  - **cra/**
    - **App.jsx**
    - **index.css**
    - **main.tsx**
  - pages/
    - index.astro
  - env.d.ts
- astro.config.mjs
- package-lock.json
- package.json
- tsconfig.json
</FileTree>

## 4. Render your SPA as a component

In the React Router project, `index.html` ran `main.tsx` as a `<script>` to render the App.

Astro can render React components directly. Instead of running `main.tsx` as a script, convert it to a default exported function.

Make the adjustments below to export your `<App />` component wrapped in the routing component as a function. Remove any unnecessary imports and the code to render your app in a DOM element. This is no longer necessary when embedding your app in Astro.

```js title="src/cra/main.tsx" ins={7,8,16,17} del={1,2,9,10,14,15}
// import * as React from "react";
// import * as ReactDOM from "react-dom/client";
import { BrowserRouter } from "react-router-dom";
import "./index.css";
import App from "./App";

export default function Main(){
  return(
// ReactDOM.createRoot(document.getElementById("root")!).render(
  // <React.StrictMode>
      <BrowserRouter>
        <App />
      </BrowserRouter>
  // </React.StrictMode>
// );
  );
}
```

Now, import and render `<Main />` as a component in `src/pages/index.astro`. Use the `client:only="react"` [client directive](/en/reference/directives-reference/#client-directives) to allow the app to run entirely in the client.

```astro title="src/pages/index.astro" ins={2,15}
---
import Main from "../cra/main.tsx"
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Astro</title>
	</head>
	<body>
		<h1>Astro</h1>
		<Main client:only="react"/> 
	</body>
</html>
```

Now, when you navigate to the root of your Astro project in the browser, you will see a fully-functional embedded SPA using React Router to control its own routing.

## Next Steps

Note that more complex Apps may require additional troubleshooting. Read more about [using UI framework components](/en/core-concepts/framework-components/) in Astro for more advanced patterns and usage.
